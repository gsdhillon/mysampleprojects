/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package SmartTimeApplet.services.employee;

import SmartTimeApplet.session.MSC;
import SmartTimeApplet.session.MyUtils;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.BorderFactory;
import javax.swing.JCheckBox;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import net.sourceforge.jdatepicker.DateModel;
import net.sourceforge.jdatepicker.JDateComponent;
import net.sourceforge.jdatepicker.JDateComponentFactory;
import net.sourceforge.jdatepicker.JDatePicker;
import sample_lib.gui.*;
import sample_lib.utils.Depacketizer;
import sample_lib.utils.Packetizer;

/**
 *
 */
public class EmployeeMaster extends MyPanel implements ActionListener {

    private MyTextField txtCCNo;
    private MyTextField txtEmpCode;
    private MyTextField txtEmpNm;
    private MyTextField txtDesig;
    private JComponent dob;
    private JComponent doj;
    private JComponent dol;
    private JComboBox cmbDivCode;
    private MyTextField txtDivNm;
    private MyTextField txtDivHead;
    private JComboBox cmbCatCode, cmbAccessLevel;
    private MyTextField txtCatNm;
    private MyTextField txtReport;
    private MyButton btnAdd;
    private MyButton btnCancel;
    private MyTextField txtSecHead;
    private JComboBox cmbSecNm;
    private JComboBox cmbWorkL;
    private MyTextArea taAdd;
    private MyTextField txtBalLeave;
    private JComboBox cmbLCode;
    private JComboBox cmbSex;
    private JComboBox cmbDShift;
    private JComboBox cmbSSwipe;
    private JComboBox cmbWOff1;
    private JComboBox cmbWOff2;
    private Employee EmployeeApplet;
    private String Job;
    private String EmpCode;
    private MyPanel panEmpDetail;

    public EmployeeMaster(Employee EmployeeApplet, String Job, String EmpCode) {
        try {
            this.EmployeeApplet = EmployeeApplet;
            this.Job = Job;
            this.EmpCode = EmpCode;
            addEmployeePanel();
            initialDetails();
            selectionEvents();
            if (Job.equals("update")) {
                FillForm();
            }
        } catch (Exception ex) {
            MyUtils.showException("Employee Master", ex);
        }

    }

    private void initialDetails() {
        try {
            MSC msc = MyUtils.getMSC("EmployeeFormServlet");
            msc.openOS();
            msc.println("InitValues");
            msc.closeOS();
            msc.openIS();

            String catcode = msc.readLine();
            if (catcode.startsWith("ERROR")) {
                MyUtils.showMessage(catcode);
                return;
            }
            Depacketizer dp = new Depacketizer(catcode);
            while (!dp.isEmpty()) {
                cmbCatCode.addItem(dp.getString());
            }

            String divcode = msc.readLine();
            if (divcode.startsWith("ERROR")) {
                MyUtils.showMessage(divcode);
                return;
            }
            dp = new Depacketizer(divcode);
            while (!dp.isEmpty()) {
                cmbDivCode.addItem(dp.getString());
            }

            String WLocation = msc.readLine();
            if (divcode.startsWith("ERROR")) {
                MyUtils.showMessage(divcode);
                return;
            }
            dp = new Depacketizer(WLocation);
            while (!dp.isEmpty()) {
                cmbWorkL.addItem(dp.getString());
            }

            String Shift = msc.readLine();
            if (Shift.startsWith("ERROR")) {
                MyUtils.showMessage(Shift);
                return;
            }
            dp = new Depacketizer(Shift);
            while (!dp.isEmpty()) {
                cmbDShift.addItem(dp.getString());
            }
            String Leave = msc.readLine();
            if (Leave.startsWith("ERROR")) {
                MyUtils.showMessage(Leave);
                return;
            }
            dp = new Depacketizer(Leave);
            while (!dp.isEmpty()) {
                cmbLCode.addItem(dp.getString());
            }
            msc.closeIS();
        } catch (Exception ex) {
            MyUtils.showException("Initial Details", ex);
        }

    }

    private void FillForm() {
        try {
            txtEmpCode.setEditable(false);

            MSC msc = MyUtils.getMSC("EmployeeFormServlet");
            msc.openOS();
            msc.println("FormDetails");
            msc.println(EmpCode);
            msc.closeOS();
            msc.openIS();
            String result = msc.readLine();
            msc.closeIS();
//            MyUtils.showMessage("result : " + result);
            if (result.startsWith("ERROR")) {
                MyUtils.showException("Database Query", new Exception(result));
            } else {
//                Depacketizer dp = new Depacketizer(result);
                setValues(result);

            }
        } catch (Exception ex) {
            MyUtils.showException("Fill Form", ex);
        }
    }

    private void setValues(String Packet) {
        try {
            Depacketizer dp = new Depacketizer(Packet);
            txtEmpNm.setText(dp.getString());
            txtEmpCode.setText(dp.getString());
            txtEmpCode.setEditable(false);
            txtCCNo.setText(dp.getString());
            //        dp.getString();
            //        dp.getString();
            //int sex = dp.getInt();
            if (dp.getString().equals("0")) {
                cmbSex.setSelectedItem("Male");
            } else {
                cmbSex.setSelectedItem("Female");
            }
            //        dp.getString();
            //        dp.getString();
            String dt1 = dp.getString();
            if ((dt1 != null) & (!"".equals(dt1))) {
                MyUtils.setDate(dob, dt1);
            }
            String dt2 = dp.getString();
            if ((dt2 != null) & (!"".equals(dt2))) {
                MyUtils.setDate(dol, dt2);
            }
            String dt3 = dp.getString();
            if ((dt3 != null) & (!"".equals(dt3))) {
                MyUtils.setDate(doj, dt3);
            }
            txtDivNm.setText(dp.getString());
            //        dp.getString();
            txtDesig.setText(dp.getString());
            cmbWorkL.setSelectedItem(dp.getString());
            //        dp.getString();
            //        dp.getString();
            //        dp.getString();
            //        dp.getString();
            //        dp.getString();
            //        dp.getString();
            cmbDivCode.setSelectedItem(dp.getString());
            String SecNm = dp.getString();
            for (int i = 0; i < cmbSecNm.getItemCount(); i++) {
                if (((String) cmbSecNm.getItemAt(i)).startsWith(SecNm)) {
                    cmbSecNm.setSelectedIndex(i);
                    break;
                }
            }
            cmbDShift.setSelectedItem(dp.getString());
            cmbCatCode.setSelectedItem(dp.getString());
            cmbLCode.setSelectedItem(dp.getString());
            String woff1 = dp.getString();
            if ("".equals(woff1)) {
                cmbWOff1.setSelectedIndex(0);
            } else {
                cmbWOff1.setSelectedItem(MyUtils.weekDay(Integer.parseInt(woff1)));
            }
            String woff2 = dp.getString();
            if ("".equals(woff2)) {
                cmbWOff2.setSelectedIndex(0);
            } else {
                cmbWOff2.setSelectedItem(MyUtils.weekDay(Integer.parseInt(woff2)));
            }

//            cmbWOff2.setSelectedItem(MyUtils.weekDay(Integer.parseInt(dp.getString())));
            //        dp.getString();
            if ("0".equals(dp.getString())) {
                cmbSSwipe.setSelectedItem("No");
            } else {
                cmbSSwipe.setSelectedItem("Yes");
            }
            txtBalLeave.setText(dp.getString());
            txtReport.setText(dp.getString());
            taAdd.setText(dp.getString());
//            getSectionHead();
        } catch (Exception ex) {
            MyUtils.showException("setValues ", ex);
        }
    }

    private void selectionEvents() {
        cmbDivCode.addActionListener(this);
        cmbDivCode.setActionCommand("DivCode");
        cmbCatCode.addActionListener(this);
        cmbCatCode.setActionCommand("CatCode");
        cmbSecNm.addActionListener(this);
        cmbSecNm.setActionCommand("SecName");

    }

    private boolean FormFilled() {

        if (cmbDivCode.getSelectedItem().equals("Select Division Code")) {
            MyUtils.showMessage("Division Code not Selected");
            return false;
        }
        if (cmbCatCode.getSelectedItem().equals("Select Category Code")) {
            MyUtils.showMessage("Category Code Not Selected");
            return false;

        }
        if (cmbSecNm.getSelectedItem().equals("Select Section Name")) {
            MyUtils.showMessage("Section Name Not Selected");
            return false;

        }
        if (cmbWorkL.getSelectedItem().equals("Select Work Location")) {
            MyUtils.showMessage("Work Location not Selected");
            return false;
        }
        if (cmbSex.getSelectedItem().equals("Select Sex")) {
            MyUtils.showMessage("Employee Sex not Selected");
            return false;
        }
        if (cmbDShift.getSelectedItem().equals("Select Default Shift")) {
            MyUtils.showMessage("Default Shift not Selected");
            return false;
        }
        if (cmbSSwipe.getSelectedItem().equals("Select Yes/No")) {
            MyUtils.showMessage("Swipe not Selected");
            return false;
        }
        if (cmbLCode.getSelectedItem().equals("Select Leave Code")) {
            MyUtils.showMessage("Leave Code not Selected");
            return false;
        }
        DateModel model1 = ((JDateComponent) (dob)).getModel();
        if ((!model1.isSelected())) {
            MyUtils.showMessage("Date Of Birth not Selected");
            return false;
        }
        DateModel model2 = ((JDateComponent) (doj)).getModel();
        if ((!model2.isSelected())) {
            MyUtils.showMessage("Date Of Joining not Selected");
            return false;
        }
        DateModel model3 = ((JDateComponent) (dol)).getModel();
        if ((!model3.isSelected())) {
            MyUtils.showMessage("Date Of Leaving not Selected");
            return false;
        }
        if (txtDesig.getText().equals("") || txtCCNo.getText().equals("")
                || txtEmpNm.getText().equals("") || txtEmpCode.getText().equals("")
                || txtReport.equals("") || taAdd.getText().equals("")) {
            MyUtils.showMessage("Form not filled");
            return false;
        }

        return true;
    }

    private String CreatePacket() {
        Packetizer a = new Packetizer();
        try {
            a.addString(txtCCNo.getText());
            a.addString(txtEmpCode.getText());
            a.addString(txtEmpNm.getText());
            a.addString(txtDesig.getText());
            if (cmbSex.getSelectedItem().equals("Male")) {
                a.addInt(0);
            } else if (cmbSex.getSelectedItem().equals("Female")) {
                a.addInt(1);
            }
            DateModel<?> model = ((JDateComponent) (dob)).getModel();
            String date = model.getYear() + "-" + (model.getMonth() + 1) + "-" + model.getDay();
            // MyUtils.showMessage(date);
            a.addString(date);
            model = ((JDateComponent) (doj)).getModel();
            date = model.getYear() + "-" + (model.getMonth() + 1) + "-" + model.getDay();
            // MyUtils.showMessage(date);
            a.addString(date);
            model = ((JDateComponent) (dol)).getModel();
            date = model.getYear() + "-" + (model.getMonth() + 1) + "-" + model.getDay();
            //  MyUtils.showMessage(date);
            a.addString(date);
            a.addString(txtDivNm.getText());
            a.addString((String) cmbWorkL.getSelectedItem());
            a.addString((String) cmbDivCode.getSelectedItem());
            a.addString(((String) cmbSecNm.getSelectedItem()).substring(0, 5));
            a.addString((String) cmbDShift.getSelectedItem());
            a.addInt(Integer.parseInt((String) cmbCatCode.getSelectedItem()));
            a.addInt(Integer.parseInt((String) cmbLCode.getSelectedItem()));
            a.addInt(MyUtils.weekIndex((String) cmbWOff1.getSelectedItem()));
            a.addInt(MyUtils.weekIndex((String) cmbWOff2.getSelectedItem()));
            if (cmbSSwipe.getSelectedItem().equals("No")) {
                a.addInt(0);
            } else if (cmbSSwipe.getSelectedItem().equals("Yes")) {
                a.addInt(1);
            }
            a.addString(taAdd.getText());
            a.addString(txtReport.getText());
            if (!"".equals(txtBalLeave.getText())) {
                a.addInt(Integer.parseInt(txtBalLeave.getText()));
            } else {
                a.addInt(0);
            }
        } catch (Exception ex) {
            MyUtils.showException("CreatePacket", ex);
        } finally {
            return a.getPacket();
        }

    }

    private void addEmployee() {
        if (FormFilled()) {
            String Packet = CreatePacket();
            try {
                MSC msc = MyUtils.getMSC("EmployeeFormServlet");
                msc.openOS();
                msc.println("AddEmployee");
                msc.println(Packet);
                msc.closeOS();
                msc.openIS();
                String result = msc.readLine();
                if (result.equals("Inserted")) {
                    EmployeeApplet.showHomePanel();
                } else {
                    MyUtils.showMessage(result);
                }
            } catch (Exception ex) {
                MyUtils.showException("add Employee", ex);
            }

        }
    }

    private void updateEmployee() {
        if (FormFilled()) {
            try {
                String Packet = CreatePacket();

                MSC msc = MyUtils.getMSC("EmployeeFormServlet");
                msc.openOS();
                msc.println("UpdateEmployee");
                msc.println(Packet);
                msc.closeOS();
                msc.openIS();
                String result = msc.readLine();
                msc.closeIS();
                if (result.equals("Updated")) {

                    EmployeeApplet.showHomePanel();
                } else {
                    MyUtils.showMessage(result);
                }
            } catch (Exception ex) {
                MyUtils.showException("Update Employee", ex);
            }
        }
    }

    public void addEmployeePanel() {



        //System.out.print("Width :" + this.getBounds());
        MyPanel MainPanel = new MyPanel(new BorderLayout());
        MainPanel.setBackground(Color.WHITE);

        panEmpDetail = new MyPanel(new GridLayout(1, 2, 20, 10), "Employee Details");

        panEmpDetail.setSize(EmployeeApplet.getWidth(), EmployeeApplet.getHeight() / 6);
        //panEmpDetail.setPreferredSize(new Dimension(width - 300, height / 7));
        panEmpDetail.setBackground(Color.WHITE);
        MyPanel panEmpG1 = new MyPanel(new GridLayout(3, 2, 0, 10));
        panEmpG1.setSize(EmployeeApplet.getWidth(), EmployeeApplet.getHeight() / 6);
        panEmpG1.setBackground(Color.WHITE);

        MyLabel lblCCNo = new MyLabel(1, "CC No : ");
        lblCCNo.setBackground(Color.WHITE);
        panEmpG1.add(lblCCNo);

        txtCCNo = new MyTextField();
        panEmpG1.add(txtCCNo);

        MyLabel lblEmpCode = new MyLabel(1, "Employee Code : ");
        lblEmpCode.setBackground(Color.WHITE);
        panEmpG1.add(lblEmpCode);

        txtEmpCode = new MyTextField();
        panEmpG1.add(txtEmpCode);

        MyLabel lblEmpNm = new MyLabel(1, "Employee Name : ");
        lblEmpNm.setBackground(Color.WHITE);
        panEmpG1.add(lblEmpNm);

        txtEmpNm = new MyTextField();
        panEmpG1.add(txtEmpNm);

        panEmpDetail.add(panEmpG1);

        MyPanel panEmpG2 = new MyPanel(new GridLayout(4, 2, 20, 5));
        panEmpG2.setSize(EmployeeApplet.getWidth(), EmployeeApplet.getHeight() / 6);
        panEmpG2.setBackground(Color.WHITE);

        MyLabel lblDesig = new MyLabel(1, "Designation : ");
        lblDesig.setBackground(Color.WHITE);
        panEmpG2.add(lblDesig);

        txtDesig = new MyTextField();
        txtDesig.setPreferredSize(new Dimension(50, 15));
        panEmpG2.add(txtDesig);

        MyLabel lblDOB = new MyLabel(1, "Date Of Birth : ");
        lblDOB.setBackground(Color.WHITE);
        panEmpG2.add(lblDOB);

        JDatePicker picker = JDateComponentFactory.createJDatePicker();
        dob = (JComponent) picker;
        panEmpG2.add(dob);

        MyLabel lblDOJ = new MyLabel(1, "Date Of Joining : ");
        lblDOJ.setBackground(Color.WHITE);
        panEmpG2.add(lblDOJ);

        JDatePicker picker2 = JDateComponentFactory.createJDatePicker();
        doj = (JComponent) picker2;
        panEmpG2.add(doj);

        MyLabel lblDOL = new MyLabel(1, "Date Of Leaving : ");
        lblDOL.setBackground(Color.WHITE);
        panEmpG2.add(lblDOL);

        JDatePicker picker3 = JDateComponentFactory.createJDatePicker();
        dol = (JComponent) picker3;
        panEmpG2.add(dol);

        panEmpDetail.add(panEmpG2);
        MainPanel.add(panEmpDetail, BorderLayout.NORTH);

        MyPanel panStatus = new MyPanel();
        panStatus.setBackground(Color.WHITE);
        panStatus.setBorder(BorderFactory.createLineBorder(Color.WHITE));
        MyLabel lblStatus = new MyLabel(1, "");
        //lblStatus.setPreferredSize(new Dimension(width - 10, height / 35));

        lblStatus.setBackground(Color.WHITE);
        panStatus.add(lblStatus);

        MainPanel.add(panStatus, BorderLayout.SOUTH);

        MyPanel panCenter = new MyPanel(new BorderLayout());
        panCenter.setBackground(Color.WHITE);

        MyPanel panDeptCat = new MyPanel(new GridLayout(1, 2, 20, 5), "Division Details");
        //panDeptCat.setPreferredSize(new Dimension(width - 300, height / 8));
        panDeptCat.setBackground(Color.WHITE);

        MyPanel panDept = new MyPanel(new GridLayout(3, 2, 20, 5));
        panDept.setBackground(Color.WHITE);

        MyLabel lblDeptCode = new MyLabel(1, "Division Code : ");
        lblDeptCode.setBackground(Color.WHITE);
        panDept.add(lblDeptCode);

        cmbDivCode = new JComboBox();
        cmbDivCode.addItem("Select Division Code");
        panDept.add(cmbDivCode);

        MyLabel lblDeptNm = new MyLabel(1, "Division Name : ");
        lblDeptNm.setBackground(Color.WHITE);
        panDept.add(lblDeptNm);

        txtDivNm = new MyTextField();
        txtDivNm.setEditable(false);
        panDept.add(txtDivNm);

        MyLabel lblDeptHead = new MyLabel(1, "Division Head : ");
        lblDeptHead.setBackground(Color.WHITE);
        panDept.add(lblDeptHead);

        txtDivHead = new MyTextField();
        txtDivHead.setEditable(false);
        panDept.add(txtDivHead);

        MyPanel panCat = new MyPanel(new GridLayout(3, 2, 20, 5));
        panCat.setBackground(Color.WHITE);

        MyLabel lblCatCode = new MyLabel(1, "Category Code : ");
        lblCatCode.setBackground(Color.WHITE);
        panCat.add(lblCatCode);

        cmbCatCode = new JComboBox();
        cmbCatCode.addItem("Select Category Code");
        panCat.add(cmbCatCode);

        MyLabel lblCatNm = new MyLabel(1, "Category Name : ");
        lblCatNm.setBackground(Color.WHITE);
        panCat.add(lblCatNm);

        txtCatNm = new MyTextField();
        txtCatNm.setEditable(false);
        panCat.add(txtCatNm);

        MyLabel lblReport = new MyLabel(1, "Reporting to : ");
        lblReport.setBackground(Color.WHITE);
        panCat.add(lblReport);

        txtReport = new MyTextField();
        panCat.add(txtReport);

        panDeptCat.add(panDept);
        panDeptCat.add(panCat);
        panCenter.add(panDeptCat, BorderLayout.NORTH);

        MyPanel panButtons = new MyPanel(new FlowLayout(FlowLayout.CENTER), "Edit Employee Details");
        panButtons.setBackground(Color.WHITE);
        if (Job.equals("add")) {
            btnAdd = new MyButton("Add Employee", 2, Color.WHITE) {

                @Override
                public void onClick() {
                    addEmployee();
                }
            };
        } else if (Job.equals("update")) {
            btnAdd = new MyButton("Update Employee", 2, Color.WHITE) {

                @Override
                public void onClick() {
                    updateEmployee();
                }
            };
        }
        panButtons.add(btnAdd);

        btnCancel = new MyButton("Cancel", 2, Color.WHITE) {

            @Override
            public void onClick() {

                EmployeeApplet.showHomePanel();
            }
        };
        panButtons.add(btnCancel);

        panCenter.add(panButtons, BorderLayout.SOUTH);

        MyPanel panSecNShift = new MyPanel(new BorderLayout());
        panSecNShift.setBackground(Color.WHITE);

        MyPanel panSection = new MyPanel(new GridLayout(1, 2, 20, 5), "Section Details");
        //panSection.setPreferredSize(new Dimension(width - 300, height / 10));
        panSection.setBackground(Color.WHITE);

        MyPanel panSectionG1 = new MyPanel(new GridLayout(2, 2, 20, 5));
        panSectionG1.setBackground(Color.WHITE);

        MyLabel lblSecNm = new MyLabel(1, "Section Name :");
        lblSecNm.setBackground(Color.WHITE);
        panSectionG1.add(lblSecNm);

        cmbSecNm = new JComboBox();
        cmbSecNm.addItem("First Select Division Code");
        panSectionG1.add(cmbSecNm);

        MyLabel lblWorkL = new MyLabel(1, "Work Location :");
        lblWorkL.setBackground(Color.WHITE);
        panSectionG1.add(lblWorkL);

        cmbWorkL = new JComboBox();
        cmbWorkL.addItem("Select Work Location");
        panSectionG1.add(cmbWorkL);

        panSection.add(panSectionG1);

        MyPanel panSectionG2 = new MyPanel(new GridLayout(2, 2, 20, 5));
        panSectionG2.setBackground(Color.WHITE);
        MyLabel lblSecHead = new MyLabel(1, "Section Head :");
        lblSecHead.setBackground(Color.WHITE);
        panSectionG2.add(lblSecHead);

        txtSecHead = new MyTextField();
        txtSecHead.setEditable(false);
        panSectionG2.add(txtSecHead);

        MyLabel lblFill = new MyLabel();
        lblFill.setBackground(Color.WHITE);
        panSectionG2.add(lblFill);


        panSection.add(panSectionG2);


        MyPanel panShift = new MyPanel(new BorderLayout(), "Shift Details");
        panShift.setBackground(Color.WHITE);

        MyPanel panShiftWest = new MyPanel(new GridLayout(4, 2, 0, 5));
        panShiftWest.setBackground(Color.WHITE);

        MyLabel lblSex = new MyLabel(1, "Sex :");
        lblSex.setBackground(Color.WHITE);
        panShiftWest.add(lblSex);

        cmbSex = new JComboBox();
        cmbSex.addItem("Select Sex");
        cmbSex.addItem("Male");
        cmbSex.addItem("Female");
        panShiftWest.add(cmbSex);

        MyLabel lblDShift = new MyLabel(1, "Defualt Shift :");
        lblDShift.setBackground(Color.WHITE);
        panShiftWest.add(lblDShift);

        cmbDShift = new JComboBox();
        cmbDShift.addItem("Select Default Shift");
        panShiftWest.add(cmbDShift);

        MyLabel lblSSwipe = new MyLabel(1, "Single Swipe Allowed :");
        lblSSwipe.setBackground(Color.WHITE);
        panShiftWest.add(lblSSwipe);

        cmbSSwipe = new JComboBox();
        cmbSSwipe.addItem("Select Yes/No");
        cmbSSwipe.addItem("No");
        cmbSSwipe.addItem("Yes");
        panShiftWest.add(cmbSSwipe);

        MyLabel lblLCode = new MyLabel(1, "Leave Code :");
        lblLCode.setBackground(Color.WHITE);
        panShiftWest.add(lblLCode);

        cmbLCode = new JComboBox();
        cmbLCode.addItem("Select Leave Code");
        panShiftWest.add(cmbLCode);

        MyPanel panShiftCenter = new MyPanel(new BorderLayout());
        panShiftCenter.setBackground(Color.WHITE);

        MyPanel panRdrAcc=new MyPanel(new FlowLayout());
        cmbAccessLevel = new JComboBox(fillReaderCombo());
        panRdrAcc.add(cmbAccessLevel);
        panShiftCenter.add(cmbAccessLevel, BorderLayout.NORTH);

        MyPanel panRemainLeave = new MyPanel();
        panRemainLeave.setBackground(Color.WHITE);

        JCheckBox chkBalLeave = new JCheckBox("PreBal.Leave");
        chkBalLeave.setBackground(Color.WHITE);
        panRemainLeave.add(chkBalLeave);

        txtBalLeave = new MyTextField(2);
        panRemainLeave.add(txtBalLeave);

        panShiftCenter.add(panRemainLeave, BorderLayout.SOUTH);


        MyPanel panShiftEast = new MyPanel(new GridLayout(2, 1, 0, 5));
        panShiftEast.setBackground(Color.WHITE);

        MyPanel panWOff = new MyPanel(new GridLayout(2, 2, 0, 5));
        panWOff.setBackground(Color.WHITE);

        MyLabel lblWOff1 = new MyLabel(1, "Week Off 1 :");
        lblWOff1.setBackground(Color.WHITE);
        panWOff.add(lblWOff1);

        cmbWOff1 = new JComboBox();
        addWeekDays(cmbWOff1);
        panWOff.add(cmbWOff1);

        MyLabel lblWOff2 = new MyLabel(1, "Week Off 2 :");
        lblWOff2.setBackground(Color.WHITE);

        panWOff.add(lblWOff2);

        cmbWOff2 = new JComboBox();
        addWeekDays(cmbWOff2);
        panWOff.add(cmbWOff2);

        MyPanel panAddress = new MyPanel(new GridLayout(1, 2));
        panAddress.setBackground(Color.WHITE);

        MyLabel lblAddrs = new MyLabel(1, "Address :");
        lblAddrs.setBackground(Color.WHITE);
        panAddress.add(lblAddrs);

        taAdd = new MyTextArea();
        taAdd.setBorder(BorderFactory.createLineBorder(Color.GRAY));
        panAddress.add(taAdd);

        panShiftEast.add(panWOff);
        panShiftEast.add(panAddress);


        panShift.add(panShiftWest, BorderLayout.WEST);
        panShift.add(panShiftCenter, BorderLayout.CENTER);
        panShift.add(panShiftEast, BorderLayout.EAST);

        panSecNShift.add(panSection, BorderLayout.NORTH);
        panSecNShift.add(panShift, BorderLayout.CENTER);

        panCenter.add(panSecNShift, BorderLayout.CENTER);
        MainPanel.add(panCenter, BorderLayout.CENTER);

        this.setLayout(new BorderLayout());
        this.add(MainPanel, BorderLayout.CENTER);
        setVisible(true);


    }

    private void addWeekDays(JComboBox cmb) {
        cmb.addItem("none");
        cmb.addItem("Sunday");
        cmb.addItem("Monday");
        cmb.addItem("Tuesday");
        cmb.addItem("Wednesday");
        cmb.addItem("Thrusday");
        cmb.addItem("Friday");
        cmb.addItem("Saturday");
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        try {
            if (e.getActionCommand().equals("DivCode")) {

                String DivCode = (String) cmbDivCode.getSelectedItem();

                if (DivCode.equals("Select Division Code")) {
                    return;
                }
                MSC msc = MyUtils.getMSC("EmployeeFormServlet");
                msc.openOS();
                msc.println("DivCode");
                msc.println(DivCode);
                msc.closeOS();
                msc.openIS();
                String r = msc.readLine();
                msc.closeIS();
                if (r.startsWith("ERROR")) {
                    MyUtils.showMessage(r);
                } else {
                    Depacketizer dp = new Depacketizer(r);
                    txtDivNm.setText(dp.getString());
                    txtDivHead.setText(dp.getString());
                    cmbSecNm.removeAllItems();
                    cmbSecNm.addItem("Select Section Name");
                    while (!dp.isEmpty()) {
                        cmbSecNm.addItem(dp.getString());

                    }
                }

            } else if (e.getActionCommand().equals("CatCode")) {

                String CatCode = (String) cmbCatCode.getSelectedItem();
                if (CatCode.equals("Select Category Code")) {
                    return;
                }
                MSC msc = MyUtils.getMSC("EmployeeFormServlet");
                msc.openOS();
                msc.println("CatCode");
                msc.println(CatCode);
                msc.closeOS();
                msc.openIS();
                String r = msc.readLine();
                msc.closeIS();

                if (r.startsWith("ERROR")) {
                    MyUtils.showMessage(r);
                } else {
                    Depacketizer dp = new Depacketizer(r);
                    txtCatNm.setText(dp.getString());

                }
            } else if (e.getActionCommand().equals("SecName")) {
                getSectionHead();
            }
        } catch (Exception ex) {
            MyUtils.showException("ActionListener", ex);
        }
    }

    private void getSectionHead() {
        try {
            if (cmbSecNm.getItemCount() == 0) {
                return;
            }

            String SecName = (String) cmbSecNm.getSelectedItem();

            if (SecName.equals("Select Section Name") || SecName.equals("First Select Division Code")) {
                return;
            }
//            MyUtils.showMessage("SecName : " + SecName);
            String sec_code[] = SecName.split(" ");
//                SecName = SecName.substring(0, 5);
            MSC msc = MyUtils.getMSC("EmployeeFormServlet");
            msc.openOS();
            msc.println("SecName");
            msc.println(sec_code[0]);
            msc.closeOS();
            msc.openIS();
            String r = msc.readLine();
            msc.closeIS();
            txtSecHead.setText(r);
        } catch (Exception ex) {
            Logger.getLogger(EmployeeMaster.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private String[] fillReaderCombo() {
        String strAccesslevel[] = {"Select AccessLevel", ""
            + "AccessLevel 1", ""
            + "AccessLevel 2", ""
            + "AccessLevel 3", ""
            + "AccessLevel 4", ""
            + "AccessLevel 5", ""
            + "AccessLevel 6", ""
            + "AccessLevel 7", ""
            + "AccessLevel 8", ""
            + "AccessLevel 9", ""
            + "AccessLevel 10", ""
            + "AccessLevel 11", ""
            + "AccessLevel 12", ""
            + "AccessLevel 13", ""
            + "AccessLevel 14", ""
            + "AccessLevel 15", ""
            + "AccessLevel 16", ""
            + "AccessLevel 17", ""
            + "AccessLevel 18", ""
            + "AccessLevel 19", ""
            + "AccessLevel 20", ""
            + "AccessLevel 21", ""
            + "AccessLevel 22", ""
            + "AccessLevel 23", ""
            + "AccessLevel 24", ""
            + "AccessLevel 25", ""
            + "AccessLevel 26", ""
            + "AccessLevel 27", ""
            + "AccessLevel 28", ""
            + "AccessLevel 29", ""
            + "AccessLevel 30", ""
            + "AccessLevel 31", ""
            + "AccessLevel 32", ""
            + "AccessLevel 33", ""
            + "AccessLevel 34", ""
            + "AccessLevel 35", ""
            + "AccessLevel 36", ""
            + "AccessLevel 37", ""
            + "AccessLevel 38", ""
            + "AccessLevel 39", ""
            + "AccessLevel 40", ""
            + "AccessLevel 41", ""
            + "AccessLevel 42", ""
            + "AccessLevel 43", ""
            + "AccessLevel 44", ""
            + "AccessLevel 45", ""
            + "AccessLevel 46", ""
            + "AccessLevel 47", ""
            + "AccessLevel 48", ""
            + "AccessLevel 49", ""
            + "AccessLevel 50"};
        return strAccesslevel;
    }
}
